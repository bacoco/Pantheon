# Intelligent Commit Message Patterns

## Overview
This library provides patterns for generating intelligent, contextual commit messages based on file changes, project phase, and development context.

## Commit Message Structure

### Conventional Commits Format (Default)
```
<type>[optional scope]: <description>

[optional body]

[optional footer(s)]
```

### Types Based on Changes
- **feat**: New feature or functionality
- **fix**: Bug fix
- **docs**: Documentation only changes
- **style**: Code style changes (formatting, semicolons, etc)
- **refactor**: Code change that neither fixes a bug nor adds a feature
- **perf**: Performance improvements
- **test**: Adding or updating tests
- **build**: Changes to build system or dependencies
- **ci**: Changes to CI configuration files
- **chore**: Other changes that don't modify src or test files

## Intelligent Detection Patterns

### File-Based Type Detection

#### Feature Detection
Files that indicate new features:
```
- New component files: src/components/NewComponent.tsx
- New API endpoints: api/routes/newEndpoint.js
- New pages: pages/new-feature.tsx
- New models: models/NewModel.js
```
→ Commit type: `feat`

#### Fix Detection
Indicators of bug fixes:
```
- Files with "fix" in path: bugfix/issue-123.js
- Small changes to existing logic files
- Changes to error handling code
- Updates to validation logic
```
→ Commit type: `fix`

#### Test Detection
Test-related changes:
```
- Files matching: *.test.js, *.spec.ts, __tests__/*
- New files in test/ or tests/ directories
- Jest snapshots: *.snap
- Test utilities: testUtils.js, setupTests.js
```
→ Commit type: `test`

#### Documentation Detection
Documentation changes:
```
- *.md files (README, CHANGELOG, etc)
- Files in docs/ directory
- JSDoc comment changes
- API documentation updates
```
→ Commit type: `docs`

### Change Analysis Patterns

#### New File Patterns
When creating new files, analyze:
1. File extension and location
2. File name patterns
3. Directory structure
4. Import statements

Example analyses:
```
New file: src/components/UserProfile.tsx
→ "feat(components): add UserProfile component"

New file: src/utils/validation.js
→ "feat(utils): add validation utilities"

New file: tests/auth.test.js
→ "test: add authentication tests"
```

#### Modified File Patterns
For existing files, consider:
1. Number of lines changed
2. Type of changes (logic, style, refactor)
3. File's primary purpose
4. Related files changed together

Example analyses:
```
Modified: src/api/user.js (5 lines)
→ "fix(api): resolve user endpoint error"

Modified: src/components/Button.tsx (50+ lines)
→ "refactor(components): improve Button component structure"

Modified: package.json, package-lock.json
→ "build: update dependencies"
```

## Phase-Based Commit Messages

### BACO Phase Integration
When committing after BACO phases, include phase information:

```
Phase 1/4: Foundation
→ "feat: implement project foundation (Phase 1/4)"

Phase 2/4: Core Features  
→ "feat: add core user features (Phase 2/4)"

Phase 3/4: Integration
→ "feat: integrate external services (Phase 3/4)"

Phase 4/4: Polish
→ "feat: complete project polish and optimization (Phase 4/4)"
```

### Automatic Body Generation
Include relevant details in commit body:

```
feat: implement user authentication (Phase 1/3)

- Add JWT-based authentication
- Create login/logout endpoints
- Implement password hashing
- Add session management

Tests: ✅ All passing (24 tests)
Coverage: 87%
Generated by BACO
```

## Smart Scope Detection

### Component Scope
Detect from file paths:
```
src/components/Button.tsx → scope: "components"
src/hooks/useAuth.js → scope: "hooks"
src/pages/Home.tsx → scope: "pages"
src/api/users.js → scope: "api"
```

### Feature Scope
Group related changes:
```
Changes to: auth.js, login.tsx, session.js
→ scope: "auth"

Changes to: cart.js, checkout.tsx, payment.js
→ scope: "shopping"
```

## Multi-File Commit Patterns

### Analyzing Multiple Changes
When multiple files are changed:

1. **Find Common Purpose**
   ```
   Files: UserList.tsx, UserCard.tsx, userApi.js
   → "feat(users): implement user listing feature"
   ```

2. **Identify Primary Change**
   ```
   Files: Button.tsx (90%), theme.js (10%)
   → "refactor(components): redesign Button component"
   ```

3. **Group by Feature**
   ```
   Files: auth/*, middleware/auth.js, types/auth.ts
   → "feat(auth): complete authentication system"
   ```

## Context-Aware Messages

### Test Results Integration
Include test status when available:
```
# All tests passing
"feat: add shopping cart (✅ 42 tests)"

# Some tests failing (relaxed mode)
"[WIP] feat: add payment processing (⚠️ 3 tests failing)"

# No tests
"feat: add landing page (no tests)"
```

### Breaking Changes
Detect and highlight:
```
# API changes
"feat!: update user API endpoints

BREAKING CHANGE: /api/user renamed to /api/users"

# Schema changes
"feat!: modify database schema

BREAKING CHANGE: user.fullName split into firstName/lastName"
```

## Commit Message Templates by Project Type

### Web Application
```
feat(ui): add responsive navigation menu
fix(auth): resolve token expiration issue
perf(images): optimize image loading
test(e2e): add checkout flow tests
```

### API/Backend
```
feat(api): add user search endpoint
fix(db): resolve connection pool issue
perf(cache): implement Redis caching
docs(api): update endpoint documentation
```

### Library/Package
```
feat: add array utility functions
fix: resolve TypeScript type definitions
build: update to TypeScript 5.0
docs: add usage examples
```

## Special Patterns

### WIP Commits
For work in progress (when tests fail in relaxed mode):
```
[WIP] feat: implement payment processing

Note: 3 tests failing, will fix in next commit
```

### Merge Commits
When merging branches:
```
merge: integrate feature/user-auth into main

- Complete authentication system
- All tests passing
- Ready for deployment
```

### Hotfix Commits
For urgent fixes:
```
hotfix: patch critical security vulnerability

- Update dependencies
- Fix XSS vulnerability in user input
- Add security tests
```

## Usage Examples

### Basic Feature Commit
```
Files changed: src/components/SearchBar.tsx (new)
Analysis: New component file
Message: "feat(components): add SearchBar component"
```

### Bug Fix with Tests
```
Files changed: 
- src/utils/calculate.js (modified)
- tests/calculate.test.js (modified)
Analysis: Fix with corresponding test update
Message: "fix(utils): correct calculation logic"
```

### Multi-Feature Commit
```
Files changed:
- src/pages/Dashboard.tsx (new)
- src/components/Chart.tsx (new)
- src/hooks/useData.js (new)
- src/api/analytics.js (new)
Analysis: Complete dashboard feature
Message: "feat(dashboard): implement analytics dashboard"
```

### Dependency Update
```
Files changed:
- package.json
- package-lock.json
Analysis: Dependency changes
Message: "build(deps): update React to v18.2.0"
```

## Best Practices

1. **Be Specific**: "fix login bug" → "fix(auth): resolve OAuth timeout issue"
2. **Use Present Tense**: "added" → "add"
3. **Keep First Line Under 50 Chars**: Break into body if needed
4. **Include Context**: Reference issue numbers, phases, test results
5. **Group Related Changes**: Don't mix features and fixes

## Integration with BACO

When BACO generates commits:
1. Analyze all changed files
2. Determine primary change type
3. Extract meaningful scope
4. Generate descriptive message
5. Include phase/test information
6. Add "Generated by BACO" footer

Example BACO commit:
```
feat(auth): implement complete authentication system (Phase 2/4)

- Add user registration and login
- Implement JWT token management  
- Create auth middleware
- Add comprehensive test suite

Tests: ✅ All passing (35 tests)
Coverage: 92%
Phase: 2 of 4 - Core Features

Generated by BACO
```

Remember: Good commit messages tell the story of your project's evolution.